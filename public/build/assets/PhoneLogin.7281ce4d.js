import{o as p,c as w,l as O,n as z,d as q,r as m,f as $,w as r,i as c,b as n,a as u,h as re,g as T,ax as se,F as Z,H as le,L as ie,K as de,C as G,aJ as ce,j as ue,p as i,t as d,q as pe,J as D,O as S}from"./app.af382b17.js";import{f as U}from"./index.esm.074946f0.js";import"./auth.esm.ec72dae1.js";import{e as me,P as _e,a as fe}from"./PsLayout.0abf605b.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import"./PsLabelHeader3.a6bea238.js";import ge from"./PsButton.50ea9ded.js";import{P as he}from"./PsCard.4d6784c5.js";import ye from"./UserPhoneLoginVerificationModal.b4ff170d.js";import be from"./PsFrontendLayout.321e9621.js";import{W as ve}from"./WelcomeImage.d78236ef.js";import ke from"./PsErrorDialog.f672708f.js";import{u as we}from"./AuthStore.5c9ec011.js";import{P as xe}from"./UserProvider.940163f9.js";import"https://checkout.razorpay.com/v1/checkout.js";import"./PsIcon.25e3c482.js";import"./Icons.e6c27a10.js";import"./PsLabel.43555620.js";import"./PsModal.95640547.js";import"./toggle.12d56bd4.js";import"./vue-neat-modal.9cc57e3a.js";import"./PsButton.a8f09858.js";import"./PsTextButton.c46800ee.js";import"./PsInputWithRightIcon.f43b3aab.js";import"./PsModal.521f4d13.js";import"./PsLine.a8261381.js";import"./PsLabel.7cc3bda1.js";import"./PsLabelTitle.1afa9191.js";import"./PsInput.13da87dd.js";import"./FooterView.73599f57.js";import"./FooterLinkSection.b70443bc.js";import"./PsLink.741277c6.js";import"./PsRouteLink.b1ca5aa0.js";import"./PsLabelCaption.864135d9.js";import"./PsIcon.0e44b0ec.js";import"./ProductParameterHolder.fd27bf91.js";import"./ps_constants.1e4471b7.js";import"./PsValueStore.b4213564.js";import"./AppInfoStore.3dab5ef4.js";import"./PsApiService.e3897525.js";import"./PsObject.a17ef38f.js";import"./DefaultPhoto.cc755f93.js";import"./PsNavTabBar.ee10308d.js";import"./PsDropdown.50fc1dc4.js";import"./PsDropdownSelect.9c3df235.js";import"./PsIconToggle.ee74024b.js";import"./LocationModal.1dafed17.js";import"./PsInputWithLeftIcon.5e585d7c.js";import"./LocationParameterHolder.0d5c0db7.js";import"./ItemLocationTownship.94979fe0.js";import"./PsSepetetedStore.9a31ac47.js";import"./ItemLocationTownshipStore.6e59f444.js";import"./AppInfoParameterHolder.e24d894d.js";import"./PsNavBar.61bfefbe.js";import"./UserUnReadMessageParameterHolder.55700c85.js";import"./PsConfirmDialog.81a56362.js";import"./PsUtils.aa012712.js";import"./User.fb568515.js";import"./RatingDetail.291ad5d1.js";import"./UserListParameterHolder.d110b747.js";import"./ApiStatus.5720ba0b.js";import"./PsNotificationBox.6b0524ca.js";import"./ProductStore.4b0b2789.js";import"./Product.21fd7f06.js";import"./Category.3f13b0a3.js";import"./DefaultIcon.e76b39a5.js";import"./SubCategory.1b4176e0.js";import"./NotificationStore.fafd23ed.js";import"./NotiUnRegisterHolder.eefb692e.js";const Ce={name:"PsLabel",props:{textColor:{type:String,default:"text-secondary-800 dark:text-secondary-100"}}};function Se(e,t,a,g,b,P){return p(),w("p",{class:z(["text-sm font-medium",a.textColor===""?"text-secondary-800 dark:text-secondaryDark-white":a.textColor])},[O(e.$slots,"default")],2)}var J=B(Ce,[["render",Se]]);const $e=q({name:"PsLabelTitle",components:{PsLabel:J},props:{textColor:{type:String,default:"text-secondary-800 dark:text-secondaryDark-white"}}});function Pe(e,t,a,g,b,P){const h=m("ps-label");return p(),$(h,{class:"text-base font-medium",textColor:e.textColor},{default:r(()=>[O(e.$slots,"default")]),_:3},8,["textColor"])}var Le=B($e,[["render",Pe]]);const Ne=q({name:"PsLabelCaption",components:{PsLabel:J},props:{textColor:{type:String,default:"text-secondary-800 dark:text-secondaryDark-grey"}}});function Ie(e,t,a,g,b,P){const h=m("ps-label");return p(),$(h,{class:"text-xs font-light",textColor:e.textColor},{default:r(()=>[O(e.$slots,"default")]),_:3},8,["textColor"])}var De=B(Ne,[["render",Ie]]);const Ve={name:"PsInput",props:{value:{type:String,default:""},type:{type:String,default:"text"},theme:{type:String,default:"text-secondary-500"},rounded:{type:String,default:"rounded"},maxlength:{type:Number,default:99999999},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabledTheme:{type:String,default:"bg-none text-secondary-300 border-secondary-300 dark:border-secondary-800 dark:text-secondary-700 shadow-none placeholder-secondary-300 dark:placeholder-secondary-700"},defaultBorder:{type:String,default:"border border-secondary-200 dark:border-secondary-800 focus:outline-none focus:ring-1 focus:ring-primary-500"},errorBorder:{type:String,default:"border border-red-500 focus:border-red-500 focus:ring-1 focus:ring-red-500"},onInput:Function,opacity:{type:String,default:"opacity-100"}},setup(e,{emit:t}){const a=c(!1);function g(b){t("update:value",b),e.onInput!=null&&e.onInput(b)}return{handleInput:g,isError:a}}},Me=["type","value","disabled","readonly","maxlength","placeholder"];function Be(e,t,a,g,b,P){return p(),w("input",{class:z(["block dark:bg-secondaryDark-black w-full px-4 py-2.25 text-sm shadow-sm placeholder-secondary-500",a.disabled?[a.opacity,a.rounded,a.disabledTheme]:g.isError?[a.theme,a.rounded,,a.errorBorder,a.opacity]:[a.theme,a.rounded,a.defaultBorder,a.opacity]]),type:a.type,value:a.value,disabled:a.disabled,readonly:a.readonly,maxlength:a.maxlength,placeholder:a.placeholder,onInput:t[0]||(t[0]=h=>g.handleInput(h.target.value))},null,42,Me)}var Ee=B(Ve,[["render",Be]]);const je=q({name:"PhoneLoginView",components:{Head:le,Link:ie,PsLabel:J,PsLabelTitle:Le,PsButton:ge,PsInput:Ee,UserPhoneLoginVerificationModal:ye,PsErrorDialog:ke,PsLabelCaption:De,PsCard:he,PsDangerDialog:me,WelcomeImage:ve,PsDropdown:_e,PsDropdownSelect:fe},props:{backendSetting:Object,status:String,error:String,errors:Object,phoneCodes:Object,firebaseConfig:String},layout:be,setup(e){const t=we(),a=new xe,g=de(),b=G(()=>g.getters.isDarkMode),P=G(()=>g.getters.dir),h=c(),V=c(),y=c(),L=c(),N=c();let o=ce({email:"",password:"",remember:!1,deviceToken:"",headerToken:"",loginMethod:"",google_id:"",profile_photo_url:"",name:"",displayName:"",registerMethod:"",user_phone:"",username:"",phone_id:"",phone_code:"1",phone_string:""});function F(l){N.value.openModal(D("core__be_delete_item"),D("core__be_delete_item_info"),D("core__be_btn_confirm"),D("core__be_btn_cancel"),()=>{S.Inertia.get(route("Phonelogin"))},()=>{})}const K=JSON.parse(e.firebaseConfig);U.apps.length<1&&U.initializeApp(K);const f=c(),x=c(),I=c(),E=c(),s=c(!1),j=c(!1),A=c(),W=c(),Q=c(!1);let M,_,R;t.loading.value=!1;function X(){t.loading.value=!0,setTimeout(()=>{window.recaptchaVerifier=new U.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible",callback:l=>{console.log("Callback"),console.log(l)},"expired-callback":()=>{console.log("expiry callback")}}),R=window.recaptchaVerifier,t.loading.value=!1},1e3)}ue(()=>{X()});function Y(){S.Inertia.get(route("login"))}async function ee(){L.value="",M!=null&&await M.confirm(E.value).then(async l=>{if(l!=null&&l.user!=null&&l.user.uid!=null&&l.user.uid!=""){const C=l.user;a.phoneId=C.uid,t.loading.value=!0,_.data.message.user_isexisted=="2"&&(o.loginMethod="phone",o.username=f.value,o.user_phone=x.value,o.phone_id=C.uid,S.Inertia.post(route("CreateLogin"),o,{})),_.data.message.user_isexisted=="1"&&(o.loginMethod="phone",o.username=f.value,o.email="admin@gmail.com",o.user_phone=x.value,o.password="admin@123",o.phone_id=C.uid,o.name=f.value,S.Inertia.post(route("login"),o,{}))}else t.setLoading(!1)}).catch(l=>{t.setLoading(!1),L.value=l==null?void 0:l.message})}async function oe(){let l=e.phoneCodes.filter(v=>v.id==o.phone_code)[0].country_code;x.value=l+o.phone_string,I.value=l+"-"+o.phone_string,a.userName=f.value,a.userPhone=I.value,a.displayName=o.displayName,t.loading.value=!0;const C=R;_=await t.existUser(a),_.data.status=="error"&&(h.value="",V.value="",y.value="",h.value=_.data.message.username?_.data.message.username[0]:"",V.value=_.data.message.user_phone?_.data.message.user_phone[0]:"",y.value=_.data.message.displayName?_.data.message.displayName[0]:"",t.loading.value=!1),_.data.status=="success"&&(M=await U.auth().signInWithPhoneNumber(x.value,C).catch(v=>{t.loading.value=!1,L.value=v==null?void 0:v.message}),M!=null&&A.value.openModal(D("phone_no_verification_modal__title"),"","Submit","Cancel",async v=>{t.loading.value=!0,await M.confirm(v).then(async k=>{if(k!=null&&k.user!=null&&k.user.uid!=null&&k.user.uid!=""){const H=k.user;a.phoneId=H.uid,A.value.actionClicked("no"),_.data.message.user_isexisted=="2"&&(o.loginMethod="phone",o.username=f.value,o.user_phone=I.value,o.phone_id=H.uid,S.Inertia.post(route("CreateLogin"),o,{})),_.data.message.user_isexisted=="1"&&(o.loginMethod="phone",o.username=f.value,o.email="admin@gmail.com",o.user_phone=I.value,o.password="admin@123",o.phone_id=H.uid,o.name=f.value,S.Inertia.post(route("login"),o,{}))}else t.setLoading(!1)}).catch(k=>{t.setLoading(!1),W.value.openModal(D("phone_login__error_in_sign_in"),k==null?void 0:k.message)})},()=>{console.log("Cancel")}))}function te(){S.Inertia.post(route("login"))}function ae(l){/^\/$|(\/[a-zA-Z_0-9-]+)+$/.test(l.target.value)?s.value=!0:s.value=!1}function ne(l){/^\/$|(\/[a-zA-Z_0-9-]+)+$/.test(l.target.value)?j.value=!0:j.value=!1}return{authStore:t,clicked:oe,name:f,phone:x,user_phone_login_verification_modal:A,ps_error_dialog:W,loginClicked:Y,isValidUserName:s,validateName:ae,validatePhone:ne,isValidPhone:j,dir:P,isDarkMode:b,test:te,usernameError:h,phoneError:V,ps_danger_dialog:N,confirmDeleteClicked:F,code:E,code_data_ready:Q,codeClicked:ee,codeError:L,form:o,displayNameError:y}},watch:{async errors(e){this.errors.user_ban&&(this.authStore.loading.value=!1)}}}),Te={class:"mb-6 bg-background dark:bg-backgroundDark flex flex-row mt-28 min-h-screen items-center justify-center"},Ue={class:"h-176 my-6 flex flex-row w-98 lg:w-202 rounded-md overflow-hidden shadow-md"},ze={class:"hidden w-100 h-auto bg-secondary-900 lg:flex flex-col items-center justify-center"},Fe={class:"w-65 h-50"},Ke={class:"flex-grow bg-background dark:bg-secondary-800 px-10 pb-10"},Ae={class:"px-6"},He={class:"flex"},Oe={class:"rounded-md shadow-xs w-16 bg-background dark:bg-backgroundDark"},qe={class:"pt-2 z-20"},Je={key:0},We={key:1},Re=["onClick"],Ze=u("div",{id:"recaptcha-container"},null,-1),Ge=i(),Qe=u("br",null,null,-1),Xe={class:"flex items-center justify-center mb-4 lg:mt-56"},Ye={class:"flex flex-auto justify-center mt-4 mb-10"},eo={key:0};function oo(e,t,a,g,b,P){const h=m("Head"),V=m("welcome-image"),y=m("ps-label"),L=m("ps-label-title"),N=m("ps-input"),o=m("ps-label-caption"),F=m("ps-dropdown-select"),K=m("ps-dropdown"),f=m("ps-button"),x=m("user-phone-login-verification-modal"),I=m("ps-error-dialog"),E=m("ps-danger-dialog");return p(),w(Z,null,[n(h,{title:e.$t("core__be_sign_in")},null,8,["title"]),u("div",{class:z(e.isDarkMode?"dark":"")},[u("div",Te,[u("div",Ue,[u("div",ze,[u("div",Fe,[n(V)]),n(y,{class:"text-lg font-semibold mt-6 mb-2",textColor:"text-white"},{default:r(()=>[i(d(e.$t("login_title_best_deal")),1)]),_:1}),n(y,{class:"text-base font-normal text-center mb-2 mx-10",textColor:"text-secondary-200"},{default:r(()=>[i(d(e.$t("login_description_best_deal")),1)]),_:1})]),u("div",Ke,[u("form",{onSubmit:t[4]||(t[4]=re((...s)=>e.clicked&&e.clicked(...s),["prevent"]))},[u("div",Ae,[n(L,{class:"text-center m-auto pb-8 pt-2 mt-10",textColor:"text-secondary-600 dark:text-white"},{default:r(()=>[i(d(e.$t("phone_login__phone_login")),1)]),_:1}),n(y,{class:"mt-4"},{default:r(()=>[i(d(e.$t("phone_login__display_name"))+" : ",1)]),_:1}),n(N,{class:"mt-2 placeholder-secondary-800 dark:placeholder-secondary-500",type:"text",placeholder:e.$t("phone_login__display_name_placeholder"),theme:"text-feSecondary-500 dark:bg-secondary-800",defaultBorder:"border border-secondary-200 dark:border-feSecondary-400 focus:outline-none focus:ring-1 focus:ring-primary-500",value:e.form.displayName,"onUpdate:value":t[0]||(t[0]=s=>e.form.displayName=s)},null,8,["placeholder","value"]),e.isValidUserName?(p(),$(o,{key:0,class:"mt-2 mx-8",textColor:"text-primary-500 dark:text-primaryDark-accent"},{default:r(()=>[i(d(e.$t("phone_login__user_name_required")),1)]),_:1})):T("",!0),n(o,{textColor:"text-red-500 ",class:"mt-2 block"},{default:r(()=>[i(d(e.displayName),1)]),_:1}),n(y,{class:"mt-4"},{default:r(()=>[i(d(e.$t("phone_label"))+" : ",1)]),_:1}),u("div",He,[n(K,{align:"left",class:"mt-2 w-20"},{select:r(()=>[n(F,{border:"border border-secondary-200 dark:border-feSecondary-400 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:"phone",showCenter:!0,selectedValue:e.form.phone_code==""?"":e.phoneCodes.filter(s=>s.id==e.form.phone_code)[0].country_code,onChange:t[1]||(t[1]=s=>[e.form.phone_code=e.phoneCode.id])},null,8,["selectedValue"])]),list:r(()=>[u("div",Oe,[u("div",qe,[e.phoneCodes.length===0?(p(),w("div",Je,[n(y,{class:"p-2 flex cursor-pointer"},{default:r(()=>[i(d(e.$t("core__be_add_new_category")),1)]),_:1})])):(p(),w("div",We,[(p(!0),w(Z,null,pe(e.phoneCodes,s=>(p(),w("div",{key:s.id,class:"w-96 flex py-4 px-2 hover:bg-primary-000 dark:hover:bg-secondary-700 cursor-pointer items-center",onClick:j=>[e.form.phone_code=s.id]},[n(y,{class:z(["ms-2",s.id==e.form.phone_code?" font-bold":""])},{default:r(()=>[i(d(s.country_code),1)]),_:2},1032,["class"])],8,Re))),128))]))])])]),_:1}),n(N,{class:"mt-2",onKeyup:se(e.clicked,["enter"]),onKeypress:e.validatePhone,type:"text",theme:"text-feSecondary-500 dark:bg-secondary-800",defaultBorder:"border border-secondary-200 dark:border-feSecondary-400 focus:outline-none focus:ring-1 focus:ring-primary-500",placeholder:e.$t("phone_login__phone_number_placeholderv2"),value:e.form.phone_string,"onUpdate:value":t[2]||(t[2]=s=>e.form.phone_string=s)},null,8,["onKeyup","onKeypress","placeholder","value"])]),n(o,{textColor:"text-red-500 ",class:"mt-2 block"},{default:r(()=>[i(d(e.errors.user_ban),1)]),_:1}),e.isValidPhone?(p(),$(o,{key:1,class:"mt-2 mx-8",textColor:"text-primary-500 dark:text-primaryDark-accent"},{default:r(()=>[i(d(e.$t("phone_login__phone_required")),1)]),_:1})):T("",!0),n(o,{textColor:"text-red-500 ",class:"mt-2 block"},{default:r(()=>[i(d(e.phoneError),1)]),_:1}),e.code_data_ready?(p(),$(N,{key:2,class:"mt-4",type:"text",placeholder:e.$t("phone_login__code"),value:e.code,"onUpdate:value":t[3]||(t[3]=s=>e.code=s)},null,8,["placeholder","value"])):T("",!0),n(o,{textColor:"text-red-500 ",class:"mt-2 block"},{default:r(()=>[i(d(e.codeError),1)]),_:1}),Ze,Ge,Qe,u("div",Xe,[e.authStore.loading.value?(p(),$(f,{key:0,class:"mt-6 w-full",disabled:!0},{default:r(()=>[i(d(e.$t("phone_login__loading")),1)]),_:1})):(p(),$(f,{key:1,class:"mt-6 w-full",onClick:e.clicked,disabled:!1},{default:r(()=>[i(d(e.$t("phone_login__login")),1)]),_:1},8,["onClick"]))]),u("div",Ye,[n(f,{colors:"bg-white dark:bg-secondary-800 dark:text-white ",border:"border",class:"mt-6 w-full",onClick:e.loginClicked,disabled:!1},{default:r(()=>[i(d(e.$t("core__be_btn_cancel")),1)]),_:1},8,["onClick"])])]),e.code_data_ready?(p(),w("div",eo)):T("",!0)],32)])])])],2),n(x,{ref:"user_phone_login_verification_modal"},null,512),n(I,{ref:"ps_error_dialog"},null,512),n(E,{ref:"ps_danger_dialog"},null,512)],64)}var yt=B(je,[["render",oo]]);export{yt as default};
