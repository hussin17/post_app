import dt from"./PsModal.82578ee4.js";import mt from"./PsLabel.ecef337a.js";import pt from"./PsButton.b6c86d64.js";import ut from"./PsRadio.9c925334.js";import ct from"./PsRadio2.d99f63a0.js";import ft from"./PsErrorDialog.b217bd5a.js";import _t from"./PsWarningDialog2.0afcb59b.js";import yt from"./PsIcon.6adcaac0.js";import gt from"./StripePaymentModal.8558cc1f.js";import ht from"./PaypalPaymentModal.73622b24.js";import Pt from"./OfflinePaymentModal.61f84067.js";import vt from"./InputEmailModal.654afe8f.js";import{u as kt}from"./AppInfoStore.bcf60205.js";import{P as It}from"./PsValueStore.f831f7aa.js";import{u as wt}from"./UserStore.d31b8799.js";import{a as x,P as N,b as j}from"./PsApiService.175a4dd2.js";import{P as F,a as V,b as U,c as tt,L as et}from"./LimitAdTransaction.f4e54150.js";import{P as Mt}from"./PsObject.a17ef38f.js";import{A as At}from"./ApiStatus.5720ba0b.js";import{aB as nt,B as C,i as P,S as St,aZ as Lt,d as Ct,r as w,o as K,c as at,b as d,w as p,a as A,f as ot,p as k,t as f,g as Et,F as bt,q as Tt,J as O}from"./app.89c3e968.js";import{m as it}from"./PsSepetetedStore.9a31ac47.js";import{A as $t}from"./AppInfoParameterHolder.e24d894d.js";import{P as T}from"./ps_constants.1e4471b7.js";import{c as st}from"./inline.c6606910.js";import{P as $}from"./PsUtils.aa012712.js";import{f as Nt}from"./format.min.96be0c47.js";import{_ as Rt}from"./plugin-vue_export-helper.21dcd24c.js";class W extends Mt{constructor(){super(...arguments),this.id="",this.paymentId="",this.coreKeysId="",this.shopId="",this.payment=new F,this.purchasedCount="",this.paymentInfo=new V,this.paymentAttributes=new U,this.addedDateStr=""}init(t,e,l,c,u,i,_,g,y){return this.id=t,this.paymentId=e,this.coreKeysId=l,this.shopId=c,this.payment=u,this.purchasedCount=i,this.paymentInfo=_,this.paymentAttributes=g,this.addedDateStr=y,this}getPrimaryKey(){return this.id}toMap(t){const e={};return e.id=t.id,e.payment_id=t.paymentId,e.coreKeys_id=t.coreKeysId,e.shop_id=t.shopId,e.payment=new F().toMap(t.payment),e.purchased_count=t.purchasedCount,e.payment_info=new V().toMap(t.paymentInfo),e.payment_attributes=new U().toMap(t.paymentAttributes),e.added_date_str=t.addedDateStr,e}toMapList(t){const e=[];for(let l=0;l<t.length;l++)t[l]!=null&&e.push(this.toMap(t[l]));return e}fromMap(t){return new W().init(t.id,t.payment_id,t.core_keys_id,t.shop_id,new F().fromMap(t.payment),t.purchased_count,new V().fromMap(t.payment_info),new U().fromMap(t.payment_attributes),t.added_date_str)}fromMapList(t){const e=[];for(const l in t)l!=null&&e.push(this.fromMap(l));return e}}const Ot=it(a=>nt(`packageStore/${a}`,()=>{const t=C(new x),e=C(new x),l=C({value:!1});let c=P(30),u=0;const i=C({value:!1});function _(s){var r,E;t!=null&&t.data!=null&&t.data.length>0&&u!=0?(s.data!=null&&s.data.length>0?(((r=s.data)==null?void 0:r.length)<c.value?i.value=!0:i.value=!1,t.data.push(...s.data)):i.value=!0,t.code=s.code,t.status=s.status,t.message=s.message):(((E=s.data)==null?void 0:E.length)<c.value||s.data==null?i.value=!0:i.value=!1,t.data=s.data,t.code=s.code,t.status=s.status,t.message=s.message),t!=null&&t.data!=null&&(u=t.data.length)}async function g(s){u=0,l.value=!0;const r=await N.getPackageList(new tt,s);_(r),l.value=!1}async function y(s){l.value=!0;const r=await N.getPackageList(new tt,s);_(r),l.value=!1}async function h(s){l.value=!0;const r=await N.getPackageListWithPurchasedCount(new W,s);return t.data=r.data,t.code=r.code,t.status=r.status,t.message=r.message,l.value=!1,t}async function o(s,r){l.value=!0;const E=await N.postPackageBought(new At,s,r.toMap());return l.value=!1,E}return{isNoMoreRecord:i,loading:l,limit:c,offset:u,packageList:t,limitItem:e,resetPackageList:g,loadPackageList:y,postPackageBought:o,packageListWithPurchasedCount:h}}));class Z{constructor(){this.userId="",this.packageId="",this.paymentMethod="",this.paymentMethodNounce="",this.price="",this.razorId="",this.isPaystack=""}ItemLimitParameterHolder(){this.userId="",this.packageId="",this.paymentMethod="",this.paymentMethodNounce="",this.price="",this.razorId="",this.isPaystack=""}toMap(){const t={};return t.user_id=this.userId,t.package_id=this.packageId,t.payment_method=this.paymentMethod,t.payment_method_nonce=this.paymentMethodNounce,t.price=this.price,t.razor_id=this.razorId,t.is_paystack=this.isPaystack,t}}const Yt=it(a=>nt(`limitAdItemStore/${a}`,()=>{const t=C({value:!1}),e=C(new x),l=C(new x),c=C({value:!1});let u=P(10),i=0,_="";function g(o){var s,r;e!=null&&e.data!=null&&e.data.length>0&&i!=0?(o.data!=null&&o.data.length>0?(((s=o.data)==null?void 0:s.length)<u.value?t.value=!0:t.value=!1,e.data.push(...o.data)):t.value=!0,e.code=o.code,e.status=o.status,e.message=o.message):(((r=o.data)==null?void 0:r.length)<u.value||o.data==null?t.value=!0:t.value=!1,e.data=o.data,e.code=o.code,e.status=o.status,e.message=o.message),e!=null&&e.data!=null&&(i=e.data.length)}async function y(o){const s=new Z;s.userId=o,c.value=!0;const r=await N.getLimitAdItemList(new et,o,u.value,i,s.toMap());g(r),c.value=!1}async function h(o){const s=new Z;s.userId=o,i=0,c.value=!0;const r=await N.getLimitAdItemList(new et,o,u.value,i,s.toMap());g(r),c.value=!1}return{isNoMoreRecord:t,buyadList:e,buyad:l,loading:c,limit:u,offset:i,id:_,loadPaidAdItemList:y,resetPaidAdItemList:h}}));St.add(Lt);const zt=Ct({name:"LimitItemModal",components:{PsModal:dt,PsIcon:yt,PsLabel:mt,PsButton:pt,PsErrorDialog:ft,PsRadio2:ct,PsRadio:ut,StripePaymentModal:gt,PaypalPaymentModal:ht,OfflinePaymentModal:Pt,PsWarningDialog2:_t,InputEmailModal:vt},setup(){const a=P(),t=P(),e=P(),l=P(),c=P(),u=P(),i=P(),_=P(),g=Ot(),y=Yt(),h=new Z,o=kt(),s=new $t,r=wt(),S=It().getLoginUserId(),Y=P(0),m=P(""),M=P("");async function z(){a.value.toggle(!0),await y.resetPaidAdItemList(S),await g.resetPackageList(S);const n=await o.loadAppInfo(s);m.value=n.data.razorKey,n.status==j.SUCCESS?Y.value=parseInt(n.data.oneDay,10):Y.value=0}function H(n){o.appInfo.data.mobileSetting.is_demo_for_payment==1?i.value.openModal(O("payment__warning_title"),O("payment__confirm_message"),O("payment__ok"),O("credit_card_modal__cancel"),()=>{n=="PAYPAL"?q():n=="STRIPE"?B():n=="RAZOR"?J():n=="PAYSTACK"?G():n=="OFFLINE"&&Q()},()=>{$.log("Cancel")}):n=="PAYPAL"?q():n=="STRIPE"?B():n=="RAZOR"?J():n=="PAYSTACK"?G():n=="OFFLINE"&&Q()}function B(){a.value.toggle(!1),t.value.openModal(()=>{const n=T.PAYMENT_STRIPE_METHOD.toString();b(n)},()=>{$.log("Cancel")})}async function b(n){var I;h.userId=S,h.packageId=(I=_.value.paymentInfo)==null?void 0:I.id,h.paymentMethod=n,h.paymentMethodNounce=localStorage.paymentNonce||"",h.price=_.value.paymentAttributes.price,h.razorId=M.value||"";const v=await g.postPackageBought(S,h);a.value.toggle(!1),v.status==j.ERROR?c.value.openModal("",g.limititem.message):(localStorage.paymentNonce="",location.reload())}function q(){a.value.toggle(!1),e.value.openModal(()=>{const n=T.PAYMENT_PAYPAL_METHOD.toString();b(n)},()=>{$.log("Cancel")})}async function J(){const v=(await r.loadUser(S)).data,I={key:m.value,name:"Test Company",prefill:{email:v.userEmail,name:v.userName,contact:v.userPhone},theme:{color:"#0e9f6e"},handler:async function(R){M.value=R.razorpay_payment_id,b(T.PAYMENT_RAZOR_METHOD.toString())}},L=new window.Razorpay(I);L.open(),L.on("payment.failed",function(R){})}async function G(){var L;const v=(await r.loadUser(S)).data;let I=v.userEmail;v.userEmail==""||v.userEmail==null?u.value.openModal(R=>{var D;I=R,st.setup({key:(D=o==null?void 0:o.appInfo)==null?void 0:D.data.payStackKey,email:I,amount:_.value.price,callback:async function(rt){$.log(rt),b(T.PAYMENT_PAY_STACK_METHOD.toString())},onClose:function(){}}).openIframe()},()=>{console.log("cancel")}):st.setup({key:(L=o==null?void 0:o.appInfo)==null?void 0:L.data.payStackKey,email:I,amount:_.value.paymentAttributes.price,callback:async function(X){$.log(X),b(T.PAYMENT_PAY_STACK_METHOD.toString())},onClose:function(){}}).openIframe()}function Q(){a.value.toggle(!1),l.value.openModal(()=>{const n=T.PAYMENT_OFFLINE_METHOD.toString();b(n)},()=>{$.log("Cancel")})}function lt(n){var v,I,L;return n.toString()=="0"?O("item_price__free"):Nt((L=(I=(v=o==null?void 0:o.appInfo)==null?void 0:v.data)==null?void 0:I.mobileSetting)==null?void 0:L.price_format,n)}return{psmodal:a,openModal:z,packageprovider:g,limitProvider:y,ps_error_dialog:c,stripe_payment_modal:t,paypal_payment_modal:e,offline_payment_modal:l,selected:_,ps_warning_dialog:i,paymentClicked:H,input_email:u,formatPrice:lt}}}),Ht={class:"flex justify-between items-start"},Kt={class:""},xt={class:"flex flex-wrap"},Bt={class:"flex flex-col mt-6 sm:mt-7"},Ft={class:""},Vt={class:"flex flex-col w-full"},Ut={class:"flex flex-col w-full mt-6 gap-2 sm:gap-4",id:"r1"},Zt={class:"font-light"},Wt={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mt-6"};function qt(a,t,e,l,c,u){const i=w("ps-label"),_=w("ps-icon"),g=w("ps-radio-2"),y=w("ps-button"),h=w("ps-modal"),o=w("stripe-payment-modal"),s=w("paypal-payment-modal"),r=w("ps-warning-dialog-2"),E=w("offline-payment-modal"),S=w("ps-error-dialog"),Y=w("input-email-modal");return K(),at("div",null,[d(h,{ref:"psmodal",line:"hidden",maxWidth:"534px",isClickOut:!1,class:"h-full",bodyHeight:"max-h-72",theme:"px-4 py-8 sm:p-8 rounded-lg"},{title:p(()=>{var m,M,z,H;return[A("div",Ht,[A("div",Kt,[((m=a.limitProvider.buyadList)==null?void 0:m.data)!=null&&((H=(z=(M=a.limitProvider.buyadList)==null?void 0:M.data[0])==null?void 0:z.user)==null?void 0:H.remainingPost)==0?(K(),ot(i,{key:0,textColor:"text-lg font-semibold text-feSecondary-800 mb-2"},{default:p(()=>[k(f(a.$t("limit_item_modal__quota_running_out.")),1)]),_:1})):Et("",!0),A("div",xt,[d(i,{class:"text-lg font-semibold text-feSecondary-800 me-2"},{default:p(()=>[k(f(a.$t("limit_item_modal__limit")),1)]),_:1}),d(i,{class:"text-lg"},{default:p(()=>[k(f(a.$t("limit_item_modal__limit_post_buy")),1)]),_:1})])]),d(_,{class:"cursor-pointer dark:text-feSecondary-500",name:"close",w:"24",h:"24",onClick:t[0]||(t[0]=B=>a.psmodal.toggle(!1))})])]}),body:p(()=>[A("div",Bt,[A("div",Ft,[A("div",Vt,[d(i,{class:"font-medium text-base"},{default:p(()=>[k(f(a.$t("promote_item_modal__choose_package")),1)]),_:1}),A("div",Ut,[(K(!0),at(bt,null,Tt(a.packageprovider.packageList.data,m=>(K(),ot(g,{class:"",key:m.packageId,value:m,selectedValue:a.selected,"onUpdate:selectedValue":t[1]||(t[1]=M=>a.selected=M)},{title:p(()=>[A("div",null,[d(i,{class:"ms-2 text-sm text-feSecondary-800"},{default:p(()=>[k(f(m.paymentInfo.value)+" - "+f(m.paymentAttributes.count)+" "+f(a.$t("limit_item_modal__post")),1)]),_:2},1024)])]),price:p(()=>[d(i,{class:"font-semibold text-base"},{default:p(()=>{var M;return[A("span",Zt,f((M=m.paymentAttributes)==null?void 0:M.currencySymbol),1),k(" "+f(a.formatPrice(m.paymentAttributes.price)),1)]}),_:2},1024)]),_:2},1032,["value","selectedValue"]))),128))])])])])]),footer:p(()=>[d(i,{class:"mt-6 sm:mt-7 font-medium text-base"},{default:p(()=>[k(f(a.$t("promote_item_modal__pay_with")),1)]),_:1}),A("div",Wt,[d(y,{class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:t[2]||(t[2]=m=>a.paymentClicked("PAYPAL"))},{default:p(()=>[k(f(a.$t("promote_item_modal__pay_with_paypal")),1)]),_:1}),d(y,{class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:t[3]||(t[3]=m=>a.paymentClicked("STRIPE"))},{default:p(()=>[k(f(a.$t("promote_item_modal__pay_with_stripe")),1)]),_:1}),d(y,{class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:t[4]||(t[4]=m=>a.paymentClicked("RAZOR"))},{default:p(()=>[k(f(a.$t("promote_item_modal__pay_with_razor")),1)]),_:1}),d(y,{class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:t[5]||(t[5]=m=>a.paymentClicked("PAYSTACK"))},{default:p(()=>[k(f(a.$t("promote_item_modal__pay_with_stack")),1)]),_:1}),d(y,{class:"",padding:"px-8 py-4",rounded:"rounded-lg",onClick:t[6]||(t[6]=m=>a.paymentClicked("OFFLINE"))},{default:p(()=>[k(f(a.$t("promote_item_modal__pay_with_offline")),1)]),_:1})])]),_:1},512),d(o,{ref:"stripe_payment_modal"},null,512),d(s,{ref:"paypal_payment_modal"},null,512),d(r,{ref:"ps_warning_dialog"},null,512),d(E,{ref:"offline_payment_modal"},null,512),d(S,{ref:"ps_error_dialog"},null,512),d(Y,{ref:"input_email"},null,512)])}var Jt=Rt(zt,[["render",qt]]),Ie=Object.freeze(Object.defineProperty({__proto__:null,default:Jt},Symbol.toStringTag,{value:"Module"}));export{Jt as L,Yt as a,Ie as b,Ot as u};
